var we=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ye(T){return T&&T.__esModule&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T}var _e={exports:{}};(function(T){((te,J)=>{T.exports?T.exports=J():te.fuzzysort=J()})(we,te=>{var J=(r,e)=>{if(!r||!e)return x;var t=fe(r);G(e)||(e=E(e));var a=t.bitflags;return(a&e._bitflags)!==a?x:q(t,e)},ge=(r,e,t)=>{if(!r)return t?.all?de(e,t):ee;var a=fe(r),s=a.bitflags,o=a.containsSpace,n=N(t?.threshold||0),f=t?.limit||B,i=0,c=0,_=e.length;function S(P){i<f?(V.add(P),++i):(++c,P._score>V.peek()._score&&V.replaceTop(P))}if(t?.key)for(var w=t.key,u=0;u<_;++u){var k=e[u],d=U(k,w);if(d&&(G(d)||(d=E(d)),(s&d._bitflags)===s)){var h=q(a,d);h!==x&&(h._score<n||(h.obj=k,S(h)))}}else if(t?.keys){var F=t.keys,C=F.length;e:for(var u=0;u<_;++u){var k=e[u];{for(var y=0,g=0;g<C;++g){var w=F[g],d=U(k,w);if(!d){Y[g]=H;continue}G(d)||(d=E(d)),Y[g]=d,y|=d._bitflags}if((s&y)!==s)continue}if(o)for(let v=0;v<a.spaceSearches.length;v++)I[v]=j;for(var g=0;g<C;++g){if(d=Y[g],d===H){z[g]=H;continue}if(z[g]=q(a,d,!1,o),z[g]===x){z[g]=H;continue}if(o)for(let p=0;p<a.spaceSearches.length;p++){if(D[p]>-1e3&&I[p]>j){var L=(I[p]+D[p])/4;L>I[p]&&(I[p]=L)}D[p]>I[p]&&(I[p]=D[p])}}if(o){for(let v=0;v<a.spaceSearches.length;v++)if(I[v]===j)continue e}else{var l=!1;for(let v=0;v<C;v++)if(z[v]._score!==j){l=!0;break}if(!l)continue}var m=new oe(C);for(let v=0;v<C;v++)m[v]=z[v];if(o){var b=0;for(let v=0;v<a.spaceSearches.length;v++)b+=I[v]}else{var b=j;for(let p=0;p<C;p++){var h=m[p];if(h._score>-1e3&&b>j){var L=(b+h._score)/4;L>b&&(b=L)}h._score>b&&(b=h._score)}}if(m.obj=k,m._score=b,t?.scoreFn){if(b=t.scoreFn(m),!b)continue;b=N(b),m._score=b}b<n||S(m)}}else for(var u=0;u<_;++u){var d=e[u];if(d&&(G(d)||(d=E(d)),(s&d._bitflags)===s)){var h=q(a,d);h!==x&&(h._score<n||S(h))}}if(i===0)return ee;for(var O=new Array(i),u=i-1;u>=0;--u)O[u]=V.poll();return O.total=i+c,O},ce=(r,e="<b>",t="</b>")=>{for(var a=typeof e=="function"?e:void 0,s=r.target,o=s.length,n=r.indexes,f="",i=0,c=0,_=!1,S=[],w=0;w<o;++w){var u=s[w];if(n[c]===w){if(++c,_||(_=!0,a?(S.push(f),f=""):f+=e),c===n.length){a?(f+=u,S.push(a(f,i++)),f="",S.push(s.substr(w+1))):f+=u+t+s.substr(w+1);break}}else _&&(_=!1,a?(S.push(a(f,i++)),f=""):f+=t);f+=u}return a?S:f},K=r=>{typeof r=="number"?r=""+r:typeof r!="string"&&(r="");var e=X(r);return ae(r,{_targetLower:e._lower,_targetLowerCodes:e.lowerCodes,_bitflags:e.bitflags})},ue=()=>{Z.clear(),$.clear()};class ne{get indexes(){return this._indexes.slice(0,this._indexes.len).sort((e,t)=>e-t)}set indexes(e){return this._indexes=e}highlight(e,t){return ce(this,e,t)}get score(){return se(this._score)}set score(e){this._score=N(e)}}class oe extends Array{get score(){return se(this._score)}set score(e){this._score=N(e)}}var ae=(r,e)=>{const t=new ne;return t.target=r,t.obj=e.obj??x,t._score=e._score??j,t._indexes=e._indexes??[],t._targetLower=e._targetLower??"",t._targetLowerCodes=e._targetLowerCodes??x,t._nextBeginningIndexes=e._nextBeginningIndexes??x,t._bitflags=e._bitflags??0,t},se=r=>r===j?0:r>1?r:Math.E**(((-r+1)**.04307-1)*-2),N=r=>r===0?j:r>1?r:1-Math.pow(Math.log(r)/-2+1,1/.04307),ie=r=>{typeof r=="number"?r=""+r:typeof r!="string"&&(r=""),r=r.trim();var e=X(r),t=[];if(e.containsSpace){var a=r.split(/\s+/);a=[...new Set(a)];for(var s=0;s<a.length;s++)if(a[s]!==""){var o=X(a[s]);t.push({lowerCodes:o.lowerCodes,_lower:a[s].toLowerCase(),containsSpace:!1})}}return{lowerCodes:e.lowerCodes,_lower:e._lower,containsSpace:e.containsSpace,bitflags:e.bitflags,spaceSearches:t}},E=r=>{if(r.length>999)return K(r);var e=Z.get(r);return e!==void 0||(e=K(r),Z.set(r,e)),e},fe=r=>{if(r.length>999)return ie(r);var e=$.get(r);return e!==void 0||(e=ie(r),$.set(r,e)),e},de=(r,e)=>{var t=[];t.total=r.length;var a=e?.limit||B;if(e?.key)for(var s=0;s<r.length;s++){var o=r[s],n=U(o,e.key);if(n!=x){G(n)||(n=E(n));var f=ae(n.target,{_score:n._score,obj:o});if(t.push(f),t.length>=a)return t}}else if(e?.keys)for(var s=0;s<r.length;s++){for(var o=r[s],i=new oe(e.keys.length),c=e.keys.length-1;c>=0;--c){var n=U(o,e.keys[c]);if(!n){i[c]=H;continue}G(n)||(n=E(n)),n._score=j,n._indexes.len=0,i[c]=n}if(i.obj=o,i._score=j,t.push(i),t.length>=a)return t}else for(var s=0;s<r.length;s++){var n=r[s];if(n!=x&&(G(n)||(n=E(n)),n._score=j,n._indexes.len=0,t.push(n),t.length>=a))return t}return t},q=(r,e,t=!1,a=!1)=>{if(t===!1&&r.containsSpace)return ve(r,e,a);for(var s=r._lower,o=r.lowerCodes,n=o[0],f=e._targetLowerCodes,i=o.length,c=f.length,u=0,_=0,S=0;;){var w=n===f[_];if(w){if(M[S++]=_,++u,u===i)break;n=o[u]}if(++_,_>=c)return x}var u=0,k=!1,d=0,h=e._nextBeginningIndexes;h===x&&(h=e._nextBeginningIndexes=pe(e.target)),_=M[0]===0?0:h[M[0]-1];var F=0;if(_!==c)for(;;)if(_>=c){if(u<=0||(++F,F>200))break;--u;var C=Q[--d];_=h[C]}else{var w=o[u]===f[_];if(w){if(Q[d++]=_,++u,u===i){k=!0;break}++_}else _=h[_]}var y=i<=1?-1:e._targetLower.indexOf(s,M[0]),g=!!~y,L=g?y===0||e._nextBeginningIndexes[y-1]===y:!1;if(g&&!L){for(var l=0;l<h.length;l=h[l])if(!(l<=y)){for(var m=0;m<i&&o[m]===e._targetLowerCodes[l+m];m++);if(m===i){y=l,L=!0;break}}}var b=v=>{for(var p=0,le=0,A=1;A<i;++A)v[A]-v[A-1]!==1&&(p-=v[A],++le);var xe=v[i-1]-v[0]-(i-1);if(p-=(12+xe)*le,v[0]!==0&&(p-=v[0]*v[0]*.2),!k)p*=1e3;else{for(var re=1,A=h[0];A<c;A=h[A])++re;re>24&&(p*=(re-24)*10)}return p-=(c-i)/2,g&&(p/=1+i*i*1),L&&(p/=1+i*i*1),p-=(c-i)/2,p};if(k)if(L){for(var l=0;l<i;++l)M[l]=y+l;var O=M,P=b(M)}else var O=Q,P=b(Q);else{if(g)for(var l=0;l<i;++l)M[l]=y+l;var O=M,P=b(O)}e._score=P;for(var l=0;l<i;++l)e._indexes[l]=O[l];e._indexes.len=i;const W=new ne;return W.target=e.target,W._score=e._score,W._indexes=e._indexes,W},ve=(r,e,t)=>{for(var a=new Set,s=0,o=x,n=0,f=r.spaceSearches,i=f.length,c=0,_=()=>{for(let l=c-1;l>=0;l--)e._nextBeginningIndexes[R[l*2+0]]=R[l*2+1]},S=!1,g=0;g<i;++g){D[g]=j;var w=f[g];if(o=q(w,e),t){if(o===x)continue;S=!0}else if(o===x)return _(),x;var u=g===i-1;if(!u){var k=o._indexes,d=!0;for(let l=0;l<k.len-1;l++)if(k[l+1]-k[l]!==1){d=!1;break}if(d){var h=k[k.len-1]+1,F=e._nextBeginningIndexes[h-1];for(let l=h-1;l>=0&&F===e._nextBeginningIndexes[l];l--)e._nextBeginningIndexes[l]=h,R[c*2+0]=l,R[c*2+1]=F,c++}}s+=o._score/i,D[g]=o._score/i,o._indexes[0]<n&&(s-=(n-o._indexes[0])*2),n=o._indexes[0];for(var C=0;C<o._indexes.len;++C)a.add(o._indexes[C])}if(t&&!S)return x;_();var y=q(r,e,!0);if(y!==x&&y._score>s){if(t)for(var g=0;g<i;++g)D[g]=y._score/i;return y}t&&(o=e),o._score=s;var g=0;for(let L of a)o._indexes[g++]=L;return o._indexes.len=g,o},X=r=>{for(var e=r.length,t=r.toLowerCase(),a=[],s=0,o=!1,n=0;n<e;++n){var f=a[n]=t.charCodeAt(n);if(f===32){o=!0;continue}var i=f>=97&&f<=122?f-97:f>=48&&f<=57?26:f<=127?30:31;s|=1<<i}return{lowerCodes:a,bitflags:s,containsSpace:o,_lower:t}},he=r=>{for(var e=r.length,t=[],a=0,s=!1,o=!1,n=0;n<e;++n){var f=r.charCodeAt(n),i=f>=65&&f<=90,c=i||f>=97&&f<=122||f>=48&&f<=57,_=i&&!s||!o||!c;s=i,o=c,_&&(t[a++]=n)}return t},pe=r=>{for(var e=r.length,t=he(r),a=[],s=t[0],o=0,n=0;n<e;++n)s>n?a[n]=s:(s=t[++o],a[n]=s===void 0?e:s);return a},Z=new Map,$=new Map,M=[],Q=[],R=[],I=[],D=[],Y=[],z=[],U=(r,e)=>{var t=r[e];if(t!==void 0)return t;if(typeof e=="function")return e(r);var a=e;Array.isArray(e)||(a=e.split("."));for(var s=a.length,o=-1;r&&++o<s;)r=r[a[o]];return r},G=r=>typeof r=="object"&&typeof r._bitflags=="number",B=1/0,j=-B,ee=[];ee.total=0;var x=null,H=K(""),be=r=>{var e=[],t=0,a={},s=o=>{for(var n=0,f=e[n],i=1;i<t;){var c=i+1;n=i,c<t&&e[c]._score<e[i]._score&&(n=c),e[n-1>>1]=e[n],i=1+(n<<1)}for(var _=n-1>>1;n>0&&f._score<e[_]._score;_=(n=_)-1>>1)e[n]=e[_];e[n]=f};return a.add=o=>{var n=t;e[t++]=o;for(var f=n-1>>1;n>0&&o._score<e[f]._score;f=(n=f)-1>>1)e[n]=e[f];e[n]=o},a.poll=o=>{if(t!==0){var n=e[0];return e[0]=e[--t],s(),n}},a.peek=o=>{if(t!==0)return e[0]},a.replaceTop=o=>{e[0]=o,s()},a},V=be();return{single:J,go:ge,prepare:K,cleanup:ue}})})(_e);var ke=_e.exports,Se=ye(ke);export{Se as default};
